
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      
      <meta name="generator" content="mkdocs-0.16.2, mkdocs-material-1.6.1">
    
    
      
        <title>Relationships - Beam Documentation</title>
      
    
    
      <script src="../../../assets/javascripts/modernizr-56ade86843.js"></script>
    
    

      <link rel="stylesheet" href="../../../assets/stylesheets/application-4d0d3f2fbf.css">
      
    
<link rel="stylesheet" type="text/css" href="/css/beam.css"/>

    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../../theme/css/beam.css">
    
    
  </head>
  
  
  
  
    <body>
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="../../.." title="Beam Documentation" class="md-logo md-header-nav__button">
            <img src="../../../img/logo.svg" width="24" height="24">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  User Guide
                </span>
              
            
            Relationships
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">close</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <div class="md-header-nav__source">
          
            


  


  <a href="https://github.com/tathougies/beam" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      tathougies/beam
    </div>
  </a>

          
        </div>
      </div>
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-logo md-nav__button">
        <img src="../../../img/logo.svg">
      </i>
    
    Beam Documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/tathougies/beam" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      tathougies/beam
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../about/faq/" title="Frequently Asked Questions" class="md-nav__link">
      Frequently Asked Questions
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Tutorial
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Tutorial
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tutorials/tutorial1/" title="Part 1" class="md-nav__link">
      Part 1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tutorials/tutorial2/" title="Part 2" class="md-nav__link">
      Part 2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tutorials/tutorial3/" title="Part 3" class="md-nav__link">
      Part 3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../getting-started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../models/" title="Models" class="md-nav__link">
      Models
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../databases/" title="Databases" class="md-nav__link">
      Databases
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../basic/" title="Basic Queries" class="md-nav__link">
      Basic Queries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../select/" title="More complex SELECTs" class="md-nav__link">
      More complex SELECTs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ordering/" title="Ordering" class="md-nav__link">
      Ordering
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Relationships
      </label>
    
    <a href="./" title="Relationships" class="md-nav__link md-nav__link--active">
      Relationships
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#one-to-many" title="One-to-many" class="md-nav__link">
    One-to-many
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nullable-columns" title="Nullable columns" class="md-nav__link">
    Nullable columns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#one-to-one" title="One-to-one" class="md-nav__link">
    One-to-one
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#many-to-many" title="Many-to-many" class="md-nav__link">
    Many-to-many
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#many-to-many-with-arbitrary-data" title="Many-to-many with arbitrary data" class="md-nav__link">
    Many-to-many with arbitrary data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#declaring-many-to-many-relationships" title="Declaring many-to-many relationships" class="md-nav__link">
    Declaring many-to-many relationships
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#arbitrary-joins" title="Arbitrary Joins" class="md-nav__link">
    Arbitrary Joins
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outer-joins" title="Outer joins" class="md-nav__link">
    Outer joins
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#left-and-right-joins" title="Left and right joins" class="md-nav__link">
    Left and right joins
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#full-outer-joins" title="Full Outer joins" class="md-nav__link">
    Full Outer joins
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#subqueries" title="Subqueries" class="md-nav__link">
    Subqueries
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../aggregates/" title="Aggregates" class="md-nav__link">
      Aggregates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../combining-queries/" title="Combining queries" class="md-nav__link">
      Combining queries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../window-functions/" title="Window functions" class="md-nav__link">
      Window functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../advanced-features/" title="Advanced features" class="md-nav__link">
      Advanced features
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Schema management
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Schema management
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../schema-guide/migrations/" title="The Migrations Framework" class="md-nav__link">
      The Migrations Framework
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../schema-guide/tool/" title="The beam-migrate tool" class="md-nav__link">
      The beam-migrate tool
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../schema-guide/supported/" title="Supported migrations" class="md-nav__link">
      Supported migrations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Backends
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Backends
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../backends/beam-postgres/" title="beam-postgres" class="md-nav__link">
      beam-postgres
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../backends/beam-sqlite/" title="beam-sqlite" class="md-nav__link">
      beam-sqlite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../custom-backends/" title="Writing a Custom Backend" class="md-nav__link">
      Writing a Custom Backend
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Reference
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/models/" title="Models" class="md-nav__link">
      Models
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/expression/" title="Expressions" class="md-nav__link">
      Expressions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/queries/" title="Queries" class="md-nav__link">
      Queries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/extensibility/" title="Extending" class="md-nav__link">
      Extending
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../about/compatibility/" title="Compatibility Matrix" class="md-nav__link">
      Compatibility Matrix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#one-to-many" title="One-to-many" class="md-nav__link">
    One-to-many
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nullable-columns" title="Nullable columns" class="md-nav__link">
    Nullable columns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#one-to-one" title="One-to-one" class="md-nav__link">
    One-to-one
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#many-to-many" title="Many-to-many" class="md-nav__link">
    Many-to-many
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#many-to-many-with-arbitrary-data" title="Many-to-many with arbitrary data" class="md-nav__link">
    Many-to-many with arbitrary data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#declaring-many-to-many-relationships" title="Declaring many-to-many relationships" class="md-nav__link">
    Declaring many-to-many relationships
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#arbitrary-joins" title="Arbitrary Joins" class="md-nav__link">
    Arbitrary Joins
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outer-joins" title="Outer joins" class="md-nav__link">
    Outer joins
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#left-and-right-joins" title="Left and right joins" class="md-nav__link">
    Left and right joins
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#full-outer-joins" title="Full Outer joins" class="md-nav__link">
    Full Outer joins
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#subqueries" title="Subqueries" class="md-nav__link">
    Subqueries
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Relationships</h1>
                
                <p>Relational databases are so-named because they're good at expressing relations
among data and providing related data in queries. Beam exposes these features in
its DSL.</p>
<p>For these examples, we're going to use the <code>beam-sqlite</code> backend with the
provided sample Chinook database.</p>
<p>First, create a SQLite database from the included example.</p>
<div class="codehilite"><pre><span></span>&gt; sqlite3 chinook.db &lt; beam-sqlite/examples/chinook.sql
</pre></div>


<p>Now, load the chinook database schema in GHCi.</p>
<div class="codehilite"><pre><span></span><span class="kt">Prelude</span> <span class="kt">Database</span><span class="o">.</span><span class="kt">Beam</span><span class="o">.</span><span class="kt">Sqlite</span><span class="o">&gt;</span> <span class="kt">:</span><span class="n">load</span> <span class="n">beam</span><span class="o">-</span><span class="n">sqlite</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="kt">Chinook</span><span class="o">/</span><span class="kt">Schema</span><span class="o">.</span><span class="n">hs</span>
<span class="kt">Prelude</span> <span class="kt">Chinook</span><span class="o">.</span><span class="kt">Schema</span><span class="o">&gt;</span> <span class="n">chinook</span> <span class="ow">&lt;-</span> <span class="n">open</span> <span class="s">&quot;chinook.db&quot;</span>
</pre></div>


<p>One more thing, before we explore how beam handles relationships. Before we do, let's define a quick utility function.</p>
<div class="codehilite"><pre><span></span><span class="kt">Prelude</span> <span class="kt">Chinook</span><span class="o">.</span><span class="kt">Schema</span><span class="o">&gt;</span> <span class="kr">let</span> <span class="n">withConnectionTutorial</span> <span class="ow">=</span> <span class="n">withDatabaseDebug</span> <span class="n">putStrLn</span> <span class="n">chinook</span>
</pre></div>


<p>This function prints each of our queries to standard output before running them.
Using this function will let us see what SQL is executing.</p>
<h2 id="one-to-many">One-to-many</h2>
<p>Beam supports querying for one-to-many joins. For example, to get every
<code>InvoiceLine</code> for each <code>Invoice</code>, use the <code>oneToMany_</code> combinator.</p>
<p>
                <div class="code-nav-container">
                    
        <ul class="nav nav-tabs">
            
        <li class="nav-item">
            <a href="#tab-0-haskell" aria-controls="tab-0-haskell" role="tab" data-toggle="tab" data-lang="haskell">Haskell</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-0-sqlite3" aria-controls="tab-0-sqlite3" role="tab" data-toggle="tab" data-lang="sqlite3">Sqlite3</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-0-postgres" aria-controls="tab-0-postgres" role="tab" data-toggle="tab" data-lang="postgres">Postgres</a>
        </li>
    
        </ul>
    
        <div class="tab-content">
            
        <div role="tabpanel" class="tab-pane active" id="tab-0-haskell">
            <div class="codehilite"><pre><span></span><span class="kr">do</span> <span class="n">i</span> <span class="ow">&lt;-</span> <span class="n">all_</span> <span class="p">(</span><span class="n">invoice</span> <span class="n">chinookDb</span><span class="p">)</span>
   <span class="n">ln</span> <span class="ow">&lt;-</span> <span class="n">oneToMany_</span> <span class="p">(</span><span class="n">invoiceLine</span> <span class="n">chinookDb</span><span class="p">)</span> <span class="n">invoiceLineInvoice</span> <span class="n">i</span>
   <span class="n">pure</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ln</span><span class="p">)</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-0-sqlite3">
            <div class="codehilite"><pre><span></span><span class="go">SELECT &quot;t0&quot;.&quot;InvoiceId&quot; AS &quot;res0&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;CustomerId&quot; AS &quot;res1&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;InvoiceDate&quot; AS &quot;res2&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;BillingAddress&quot; AS &quot;res3&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;BillingCity&quot; AS &quot;res4&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;BillingState&quot; AS &quot;res5&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;BillingCountry&quot; AS &quot;res6&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;BillingPostalCode&quot; AS &quot;res7&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;Total&quot; AS &quot;res8&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;InvoiceLineId&quot; AS &quot;res9&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;InvoiceId&quot; AS &quot;res10&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;TrackId&quot; AS &quot;res11&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;UnitPrice&quot; AS &quot;res12&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;Quantity&quot; AS &quot;res13&quot;</span>
<span class="go">FROM &quot;Invoice&quot; AS &quot;t0&quot;</span>
<span class="go">INNER JOIN &quot;InvoiceLine&quot; AS &quot;t1&quot; ON (&quot;t1&quot;.&quot;InvoiceId&quot;)=(&quot;t0&quot;.&quot;InvoiceId&quot;)</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-0-postgres">
            <div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;InvoiceId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res0&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;CustomerId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res1&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;InvoiceDate&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res2&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;BillingAddress&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res3&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;BillingCity&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res4&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;BillingState&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res5&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;BillingCountry&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res6&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;BillingPostalCode&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res7&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Total&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res8&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;InvoiceLineId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res9&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;InvoiceId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res10&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;TrackId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res11&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;UnitPrice&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res12&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Quantity&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res13&quot;</span>
<span class="k">FROM</span> <span class="s s-Name">&quot;Invoice&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;t0&quot;</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="s s-Name">&quot;InvoiceLine&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;t1&quot;</span> <span class="k">ON</span> <span class="p">(</span><span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;InvoiceId&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;InvoiceId&quot;</span><span class="p">)</span>
</pre></div>

        </div>
    
        </div>
    
                </div>
                    </p>
<p>Or, if you have an actual <code>Invoice</code> (called <code>oneInvoice</code>) and you want all the
associated <code>InvoiceLine</code>s, you can use <code>val_</code> to convert <code>oneInvoice</code> to the SQL
expression level.</p>
<div class="codehilite"><pre><span></span><span class="nf">oneToMany_</span> <span class="p">(</span><span class="n">invoiceLine</span> <span class="n">chinookDb</span><span class="p">)</span> <span class="n">invoiceLineInvoice</span> <span class="p">(</span><span class="n">val_</span> <span class="n">i</span><span class="p">)</span>
</pre></div>


<p>If you find yourself repeating yourself constantly, you can define a helper.</p>
<div class="codehilite"><pre><span></span><span class="nf">invoiceLines_</span> <span class="ow">::</span> <span class="kt">OneToMany</span> <span class="kt">InvoiceT</span> <span class="kt">InvoiceLineT</span>
<span class="nf">invoiceLines_</span> <span class="ow">=</span> <span class="n">oneToMany_</span> <span class="p">(</span><span class="n">invoiceLine</span> <span class="n">chinookDb</span><span class="p">)</span> <span class="n">invoiceLineInvoice</span>
</pre></div>


<p>Then the above queries become</p>
<div class="codehilite"><pre><span></span><span class="kr">do</span> <span class="n">i</span> <span class="ow">&lt;-</span> <span class="n">all_</span> <span class="p">(</span><span class="n">invoice</span> <span class="n">chinookDb</span><span class="p">)</span>
   <span class="n">ln</span> <span class="ow">&lt;-</span> <span class="n">invoiceLines_</span> <span class="n">i</span>
</pre></div>


<p>and</p>
<div class="codehilite"><pre><span></span><span class="nf">invoiceLines</span> <span class="p">(</span><span class="n">val_</span> <span class="n">i</span><span class="p">)</span>
</pre></div>


<h3 id="nullable-columns">Nullable columns</h3>
<p>If you have a nullable foreign key in your many table, you can use
<code>oneToManyOptional_</code> and <code>OneToManyOptional</code>, respectively. For example, </p>
<h3 id="one-to-one">One-to-one</h3>
<p>One to one relationships are a special case of one to many relationships, save
for a unique constraint on one column. Thus, there are no special constructs for
one-to-one relationships.</p>
<p>For convenience, <code>oneToOne_</code> and <code>OneToOne</code> are equivalent to <code>oneToMany_</code> and
<code>OneToMany</code>. Additionally, <code>oneToMaybe_</code> and <code>OneToMaybe</code> correspond to
<code>oneToManyOptional_</code> and <code>OneToManyOptional</code>.</p>
<h2 id="many-to-many">Many-to-many</h2>
<p>Many to many relationships require a linking table, with foreign keys to each
table part of the relationship.</p>
<p>The <code>manyToMany_</code> construct can be used to fetch both, one, or no sides of a
many-to-many relationship.</p>
<div class="codehilite"><pre><span></span><span class="nf">manyToMany_</span>
  <span class="ow">::</span> <span class="p">(</span> <span class="kt">Database</span> <span class="n">db</span><span class="p">,</span> <span class="kt">Table</span> <span class="n">joinThrough</span>
     <span class="p">,</span> <span class="kt">Table</span> <span class="n">left</span><span class="p">,</span> <span class="kt">Table</span> <span class="n">right</span>
     <span class="p">,</span> <span class="kt">Sql92SelectSanityCheck</span> <span class="n">syntax</span>
     <span class="p">,</span> <span class="kt">IsSql92SelectSyntax</span> <span class="n">syntax</span>

     <span class="p">,</span> <span class="kt">SqlEq</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">)</span> <span class="p">(</span><span class="kt">PrimaryKey</span> <span class="n">left</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">))</span>
     <span class="p">,</span> <span class="kt">SqlEq</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">)</span> <span class="p">(</span><span class="kt">PrimaryKey</span> <span class="n">right</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">))</span> <span class="p">)</span>
  <span class="ow">=&gt;</span> <span class="kt">DatabaseEntity</span> <span class="n">be</span> <span class="n">db</span> <span class="p">(</span><span class="kt">TableEntity</span> <span class="n">joinThrough</span><span class="p">)</span>
  <span class="ow">-&gt;</span> <span class="p">(</span><span class="n">joinThrough</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="kt">PrimaryKey</span> <span class="n">left</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">))</span>
  <span class="ow">-&gt;</span> <span class="p">(</span><span class="n">joinThrough</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="kt">PrimaryKey</span> <span class="n">right</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">))</span>
  <span class="ow">-&gt;</span> <span class="kt">Q</span> <span class="n">syntax</span> <span class="n">db</span> <span class="n">s</span> <span class="p">(</span><span class="n">left</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">))</span> <span class="ow">-&gt;</span> <span class="kt">Q</span> <span class="n">syntax</span> <span class="n">db</span> <span class="n">s</span> <span class="p">(</span><span class="n">right</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">))</span>
  <span class="ow">-&gt;</span> <span class="kt">Q</span> <span class="n">syntax</span> <span class="n">db</span> <span class="n">s</span> <span class="p">(</span><span class="n">left</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">),</span> <span class="n">right</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">))</span>
</pre></div>


<p>This reads: for any database <code>db</code>; tables <code>joinThrough</code>, <code>left</code>, and <code>right</code>;
and sane select syntax <code>syntax</code>, where the primary keys of <code>left</code> and <code>right</code>
are comparable as value expressions and we have some way of extracting a primary
key of <code>left</code> and <code>right</code> from <code>joinThrough</code>, associate all entries of <code>left</code>
with those of <code>right</code> through <code>joinThrough</code> and return the results of <code>left</code> and
<code>right</code>.</p>
<p>The Chinook database associates multiple tracks with a playlist via the
<code>playlist_track</code> table. For example, to get all tracks from the playlists named
either "Movies" or "Music".</p>
<p>
                <div class="code-nav-container">
                    
        <ul class="nav nav-tabs">
            
        <li class="nav-item">
            <a href="#tab-1-haskell" aria-controls="tab-1-haskell" role="tab" data-toggle="tab" data-lang="haskell">Haskell</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-1-sqlite3" aria-controls="tab-1-sqlite3" role="tab" data-toggle="tab" data-lang="sqlite3">Sqlite3</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-1-postgres" aria-controls="tab-1-postgres" role="tab" data-toggle="tab" data-lang="postgres">Postgres</a>
        </li>
    
        </ul>
    
        <div class="tab-content">
            
        <div role="tabpanel" class="tab-pane active" id="tab-1-haskell">
            <div class="codehilite"><pre><span></span><span class="nf">manyToMany_</span> <span class="p">(</span><span class="n">playlistTrack</span> <span class="n">chinookDb</span><span class="p">)</span>
            <span class="n">playlistTrackPlaylistId</span> <span class="n">playlistTrackTrackId</span>

            <span class="p">(</span><span class="n">filter_</span> <span class="p">(</span><span class="nf">\</span><span class="n">p</span> <span class="ow">-&gt;</span> <span class="n">playlistName</span> <span class="n">p</span> <span class="o">==.</span> <span class="n">just_</span> <span class="p">(</span><span class="n">val_</span> <span class="s">&quot;Music&quot;</span><span class="p">)</span> <span class="o">||.</span>
                            <span class="n">playlistName</span> <span class="n">p</span> <span class="o">==.</span> <span class="n">just_</span> <span class="p">(</span><span class="n">val_</span> <span class="s">&quot;Movies&quot;</span><span class="p">))</span>
                     <span class="p">(</span><span class="n">all_</span> <span class="p">(</span><span class="n">playlist</span> <span class="n">chinookDb</span><span class="p">)))</span>

            <span class="p">(</span><span class="n">all_</span> <span class="p">(</span><span class="n">track</span> <span class="n">chinookDb</span><span class="p">))</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-1-sqlite3">
            <div class="codehilite"><pre><span></span><span class="go">SELECT &quot;t0&quot;.&quot;PlaylistId&quot; AS &quot;res0&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;Name&quot; AS &quot;res1&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;TrackId&quot; AS &quot;res2&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;Name&quot; AS &quot;res3&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;AlbumId&quot; AS &quot;res4&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;MediaTypeId&quot; AS &quot;res5&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;GenreId&quot; AS &quot;res6&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;Composer&quot; AS &quot;res7&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;Milliseconds&quot; AS &quot;res8&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;Bytes&quot; AS &quot;res9&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;UnitPrice&quot; AS &quot;res10&quot;</span>
<span class="go">FROM &quot;Playlist&quot; AS &quot;t0&quot;</span>
<span class="go">INNER JOIN &quot;Track&quot; AS &quot;t1&quot;</span>
<span class="go">INNER JOIN &quot;PlaylistTrack&quot; AS &quot;t2&quot; ON ((&quot;t2&quot;.&quot;PlaylistId&quot;)=(&quot;t0&quot;.&quot;PlaylistId&quot;))</span>
<span class="go">AND ((&quot;t2&quot;.&quot;TrackId&quot;)=(&quot;t1&quot;.&quot;TrackId&quot;))</span>
<span class="go">WHERE ((&quot;t0&quot;.&quot;Name&quot;)=(?))</span>
<span class="go">  OR ((&quot;t0&quot;.&quot;Name&quot;)=(?))</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-1-postgres">
            <div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;PlaylistId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res0&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Name&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res1&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;TrackId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res2&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Name&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res3&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;AlbumId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res4&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;MediaTypeId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res5&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;GenreId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res6&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Composer&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res7&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Milliseconds&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res8&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Bytes&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res9&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;UnitPrice&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res10&quot;</span>
<span class="k">FROM</span> <span class="s s-Name">&quot;Playlist&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;t0&quot;</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="s s-Name">&quot;Track&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;t1&quot;</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="s s-Name">&quot;PlaylistTrack&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;t2&quot;</span> <span class="k">ON</span> <span class="p">((</span><span class="s s-Name">&quot;t2&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;PlaylistId&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;PlaylistId&quot;</span><span class="p">))</span>
<span class="k">AND</span> <span class="p">((</span><span class="s s-Name">&quot;t2&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;TrackId&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;TrackId&quot;</span><span class="p">))</span>
<span class="k">WHERE</span> <span class="p">((</span><span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Name&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Music&#39;</span><span class="p">))</span>
  <span class="k">OR</span> <span class="p">((</span><span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Name&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Movies&#39;</span><span class="p">))</span>
</pre></div>

        </div>
    
        </div>
    
                </div>
                    </p>
<h3 id="many-to-many-with-arbitrary-data">Many-to-many with arbitrary data</h3>
<p>Sometimes you want to have additional data for each relationship. For this, use
<code>manyToManyPassthrough_</code>.</p>
<div class="codehilite"><pre><span></span><span class="nf">manyToManyPassthrough_</span>
  <span class="ow">::</span> <span class="p">(</span> <span class="kt">Database</span> <span class="n">db</span><span class="p">,</span> <span class="kt">Table</span> <span class="n">joinThrough</span>
     <span class="p">,</span> <span class="kt">Table</span> <span class="n">left</span><span class="p">,</span> <span class="kt">Table</span> <span class="n">right</span>
     <span class="p">,</span> <span class="kt">Sql92SelectSanityCheck</span> <span class="n">syntax</span>
     <span class="p">,</span> <span class="kt">IsSql92SelectSyntax</span> <span class="n">syntax</span>

     <span class="p">,</span> <span class="kt">SqlEq</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">)</span> <span class="p">(</span><span class="kt">PrimaryKey</span> <span class="n">left</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">))</span>
     <span class="p">,</span> <span class="kt">SqlEq</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">)</span> <span class="p">(</span><span class="kt">PrimaryKey</span> <span class="n">right</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">))</span> <span class="p">)</span>
  <span class="ow">=&gt;</span> <span class="kt">DatabaseEntity</span> <span class="n">be</span> <span class="n">db</span> <span class="p">(</span><span class="kt">TableEntity</span> <span class="n">joinThrough</span><span class="p">)</span>
  <span class="ow">-&gt;</span> <span class="p">(</span><span class="n">joinThrough</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="kt">PrimaryKey</span> <span class="n">left</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">))</span>
  <span class="ow">-&gt;</span> <span class="p">(</span><span class="n">joinThrough</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="kt">PrimaryKey</span> <span class="n">right</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">))</span>
  <span class="ow">-&gt;</span> <span class="kt">Q</span> <span class="n">syntax</span> <span class="n">db</span> <span class="n">s</span> <span class="p">(</span><span class="n">left</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">))</span>
  <span class="ow">-&gt;</span> <span class="kt">Q</span> <span class="n">syntax</span> <span class="n">db</span> <span class="n">s</span> <span class="p">(</span><span class="n">right</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">))</span>
  <span class="ow">-&gt;</span> <span class="kt">Q</span> <span class="n">syntax</span> <span class="n">db</span> <span class="n">s</span> <span class="p">(</span> <span class="n">joinThrough</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">)</span>
                   <span class="p">,</span> <span class="n">left</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">)</span>
                   <span class="p">,</span> <span class="n">right</span> <span class="p">(</span><span class="kt">QExpr</span> <span class="p">(</span><span class="kt">Sql92SelectExpressionSyntax</span> <span class="n">syntax</span><span class="p">)</span> <span class="n">s</span><span class="p">))</span>
</pre></div>


<p>Under the hood <code>manyToMany_</code> is defined simply as </p>
<div class="codehilite"><pre><span></span><span class="nf">manyToMany_</span> <span class="ow">=</span> <span class="n">fmap</span> <span class="p">(</span><span class="nf">\</span><span class="p">(</span><span class="kr">_</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span> <span class="ow">-&gt;</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">))</span> <span class="n">manyToManyPassthrough_</span>
</pre></div>


<h3 id="declaring-many-to-many-relationships">Declaring many-to-many relationships</h3>
<p>Like one-to-many relationships, beam allows you to extract commonly used
many-to-many relationships, via the <code>ManyToMany</code> type.</p>
<p>For example, the playlist/track relationship above can be defined as follows</p>
<div class="codehilite"><pre><span></span><span class="nf">playlistTrackRelationship</span> <span class="ow">::</span> <span class="kt">ManyToMany</span> <span class="kt">ChinookDb</span> <span class="kt">PlaylistT</span> <span class="kt">TrackT</span>
<span class="nf">playlistTrackRelationshipu</span> <span class="ow">=</span>
  <span class="n">manyToMany_</span> <span class="p">(</span><span class="n">playlistTrack</span> <span class="n">chinookDb</span><span class="p">)</span> <span class="n">playlistTrackPlaylistId</span> <span class="n">playlistTrackTrackId</span>
</pre></div>


<p>And we can use it as expected:</p>
<p>
                <div class="code-nav-container">
                    
        <ul class="nav nav-tabs">
            
        <li class="nav-item">
            <a href="#tab-2-haskell" aria-controls="tab-2-haskell" role="tab" data-toggle="tab" data-lang="haskell">Haskell</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-2-sqlite3" aria-controls="tab-2-sqlite3" role="tab" data-toggle="tab" data-lang="sqlite3">Sqlite3</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-2-postgres" aria-controls="tab-2-postgres" role="tab" data-toggle="tab" data-lang="postgres">Postgres</a>
        </li>
    
        </ul>
    
        <div class="tab-content">
            
        <div role="tabpanel" class="tab-pane active" id="tab-2-haskell">
            <div class="codehilite"><pre><span></span><span class="nf">playlistTrackRelationship</span>
    <span class="p">(</span><span class="n">filter_</span> <span class="p">(</span><span class="nf">\</span><span class="n">p</span> <span class="ow">-&gt;</span> <span class="n">playlistName</span> <span class="n">p</span> <span class="o">==.</span> <span class="n">just_</span> <span class="p">(</span><span class="n">val_</span> <span class="s">&quot;Music&quot;</span><span class="p">)</span> <span class="o">||.</span>
                    <span class="n">playlistName</span> <span class="n">p</span> <span class="o">==.</span> <span class="n">just_</span> <span class="p">(</span><span class="n">val_</span> <span class="s">&quot;Movies&quot;</span><span class="p">))</span>
             <span class="p">(</span><span class="n">all_</span> <span class="p">(</span><span class="n">playlist</span> <span class="n">chinookDb</span><span class="p">)))</span>

    <span class="p">(</span><span class="n">all_</span> <span class="p">(</span><span class="n">track</span> <span class="n">chinookDb</span><span class="p">))</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-2-sqlite3">
            <div class="codehilite"><pre><span></span><span class="go">SELECT &quot;t0&quot;.&quot;PlaylistId&quot; AS &quot;res0&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;Name&quot; AS &quot;res1&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;TrackId&quot; AS &quot;res2&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;Name&quot; AS &quot;res3&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;AlbumId&quot; AS &quot;res4&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;MediaTypeId&quot; AS &quot;res5&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;GenreId&quot; AS &quot;res6&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;Composer&quot; AS &quot;res7&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;Milliseconds&quot; AS &quot;res8&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;Bytes&quot; AS &quot;res9&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;UnitPrice&quot; AS &quot;res10&quot;</span>
<span class="go">FROM &quot;Playlist&quot; AS &quot;t0&quot;</span>
<span class="go">INNER JOIN &quot;Track&quot; AS &quot;t1&quot;</span>
<span class="go">INNER JOIN &quot;PlaylistTrack&quot; AS &quot;t2&quot; ON ((&quot;t2&quot;.&quot;PlaylistId&quot;)=(&quot;t0&quot;.&quot;PlaylistId&quot;))</span>
<span class="go">AND ((&quot;t2&quot;.&quot;TrackId&quot;)=(&quot;t1&quot;.&quot;TrackId&quot;))</span>
<span class="go">WHERE ((&quot;t0&quot;.&quot;Name&quot;)=(?))</span>
<span class="go">  OR ((&quot;t0&quot;.&quot;Name&quot;)=(?))</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-2-postgres">
            <div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;PlaylistId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res0&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Name&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res1&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;TrackId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res2&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Name&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res3&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;AlbumId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res4&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;MediaTypeId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res5&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;GenreId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res6&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Composer&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res7&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Milliseconds&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res8&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Bytes&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res9&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;UnitPrice&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res10&quot;</span>
<span class="k">FROM</span> <span class="s s-Name">&quot;Playlist&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;t0&quot;</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="s s-Name">&quot;Track&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;t1&quot;</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="s s-Name">&quot;PlaylistTrack&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;t2&quot;</span> <span class="k">ON</span> <span class="p">((</span><span class="s s-Name">&quot;t2&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;PlaylistId&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;PlaylistId&quot;</span><span class="p">))</span>
<span class="k">AND</span> <span class="p">((</span><span class="s s-Name">&quot;t2&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;TrackId&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;TrackId&quot;</span><span class="p">))</span>
<span class="k">WHERE</span> <span class="p">((</span><span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Name&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Music&#39;</span><span class="p">))</span>
  <span class="k">OR</span> <span class="p">((</span><span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Name&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Movies&#39;</span><span class="p">))</span>
</pre></div>

        </div>
    
        </div>
    
                </div>
                    </p>
<p><code>ManyToManyThrough</code> is the equivalent for <code>manyToManyThrough_</code>, except it takes
another table parameter for the 'through' table.</p>
<h2 id="arbitrary-joins">Arbitrary Joins</h2>
<p>Joins with arbitrary conditions can be specified using the <code>join_</code> construct.
For example, <code>oneToMany_</code> is implemented as</p>
<div class="codehilite"><pre><span></span><span class="nf">oneToMany_</span> <span class="n">rel</span> <span class="n">getKey</span> <span class="n">tbl</span> <span class="ow">=</span>
  <span class="n">join_</span> <span class="n">rel</span> <span class="p">(</span><span class="nf">\</span><span class="n">rel</span> <span class="ow">-&gt;</span> <span class="n">getKey</span> <span class="n">rel</span> <span class="o">==.</span> <span class="n">pk</span> <span class="n">tbl</span><span class="p">)</span>
</pre></div>


<p>Thus, the invoice example above could be rewritten. For example, instead of </p>
<div class="codehilite"><pre><span></span><span class="kr">do</span> <span class="n">i</span> <span class="ow">&lt;-</span> <span class="n">all_</span> <span class="p">(</span><span class="n">invoice</span> <span class="n">chinookDb</span><span class="p">)</span>
   <span class="n">ln</span> <span class="ow">&lt;-</span> <span class="n">oneToMany_</span> <span class="p">(</span><span class="n">invoiceLine</span> <span class="n">chinookDb</span><span class="p">)</span> <span class="n">invoiceLineInvoice</span> <span class="n">i</span>
   <span class="n">pure</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ln</span><span class="p">)</span>
</pre></div>


<p>We could write</p>
<p>
                <div class="code-nav-container">
                    
        <ul class="nav nav-tabs">
            
        <li class="nav-item">
            <a href="#tab-3-haskell" aria-controls="tab-3-haskell" role="tab" data-toggle="tab" data-lang="haskell">Haskell</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-3-sqlite3" aria-controls="tab-3-sqlite3" role="tab" data-toggle="tab" data-lang="sqlite3">Sqlite3</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-3-postgres" aria-controls="tab-3-postgres" role="tab" data-toggle="tab" data-lang="postgres">Postgres</a>
        </li>
    
        </ul>
    
        <div class="tab-content">
            
        <div role="tabpanel" class="tab-pane active" id="tab-3-haskell">
            <div class="codehilite"><pre><span></span><span class="kr">do</span> <span class="n">i</span> <span class="ow">&lt;-</span> <span class="n">all_</span> <span class="p">(</span><span class="n">invoice</span> <span class="n">chinookDb</span><span class="p">)</span>
   <span class="n">ln</span> <span class="ow">&lt;-</span> <span class="n">join_</span> <span class="p">(</span><span class="n">invoiceLine</span> <span class="n">chinookDb</span><span class="p">)</span> <span class="p">(</span><span class="nf">\</span><span class="n">line</span> <span class="ow">-&gt;</span> <span class="n">invoiceLineInvoice</span> <span class="n">line</span> <span class="o">==.</span> <span class="n">primaryKey</span> <span class="n">i</span><span class="p">)</span>
   <span class="n">pure</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ln</span><span class="p">)</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-3-sqlite3">
            <div class="codehilite"><pre><span></span><span class="go">SELECT &quot;t0&quot;.&quot;InvoiceId&quot; AS &quot;res0&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;CustomerId&quot; AS &quot;res1&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;InvoiceDate&quot; AS &quot;res2&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;BillingAddress&quot; AS &quot;res3&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;BillingCity&quot; AS &quot;res4&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;BillingState&quot; AS &quot;res5&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;BillingCountry&quot; AS &quot;res6&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;BillingPostalCode&quot; AS &quot;res7&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;Total&quot; AS &quot;res8&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;InvoiceLineId&quot; AS &quot;res9&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;InvoiceId&quot; AS &quot;res10&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;TrackId&quot; AS &quot;res11&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;UnitPrice&quot; AS &quot;res12&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;Quantity&quot; AS &quot;res13&quot;</span>
<span class="go">FROM &quot;Invoice&quot; AS &quot;t0&quot;</span>
<span class="go">INNER JOIN &quot;InvoiceLine&quot; AS &quot;t1&quot; ON (&quot;t1&quot;.&quot;InvoiceId&quot;)=(&quot;t0&quot;.&quot;InvoiceId&quot;)</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-3-postgres">
            <div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;InvoiceId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res0&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;CustomerId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res1&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;InvoiceDate&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res2&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;BillingAddress&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res3&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;BillingCity&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res4&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;BillingState&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res5&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;BillingCountry&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res6&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;BillingPostalCode&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res7&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Total&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res8&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;InvoiceLineId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res9&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;InvoiceId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res10&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;TrackId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res11&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;UnitPrice&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res12&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Quantity&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res13&quot;</span>
<span class="k">FROM</span> <span class="s s-Name">&quot;Invoice&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;t0&quot;</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="s s-Name">&quot;InvoiceLine&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;t1&quot;</span> <span class="k">ON</span> <span class="p">(</span><span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;InvoiceId&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;InvoiceId&quot;</span><span class="p">)</span>
</pre></div>

        </div>
    
        </div>
    
                </div>
                    </p>
<h2 id="outer-joins">Outer joins</h2>
<h3 id="left-and-right-joins">Left and right joins</h3>
<p>Left joins with arbitrary conditions can be specified with the <code>leftJoin_</code>
construct. <code>leftJoin_</code> takes a table and a join condition. It associates each
result record with a record of the table given or an fully NULL row of that
table in case no row matches. For this reason, the result of <code>leftJoin_</code> has an
extra <code>Nullable</code> column tag, which converts each field into the corresponding
<code>Maybe</code> type.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The table parameter passed in as the join condition does not have a 
<code>Nullable</code> column tag. The join condition should be written as if a 
concrete row from that table exists.</p>
</div>
<p>For example, to get every artist along with their albums, but always including
every artist, use <code>leftJoin_</code> as follows.</p>
<p>
                <div class="code-nav-container">
                    
        <ul class="nav nav-tabs">
            
        <li class="nav-item">
            <a href="#tab-4-haskell" aria-controls="tab-4-haskell" role="tab" data-toggle="tab" data-lang="haskell">Haskell</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-4-sqlite3" aria-controls="tab-4-sqlite3" role="tab" data-toggle="tab" data-lang="sqlite3">Sqlite3</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-4-postgres" aria-controls="tab-4-postgres" role="tab" data-toggle="tab" data-lang="postgres">Postgres</a>
        </li>
    
        </ul>
    
        <div class="tab-content">
            
        <div role="tabpanel" class="tab-pane active" id="tab-4-haskell">
            <div class="codehilite"><pre><span></span><span class="kr">do</span> <span class="n">artist</span> <span class="ow">&lt;-</span> <span class="n">all_</span> <span class="p">(</span><span class="n">artist</span> <span class="n">chinookDb</span><span class="p">)</span>
   <span class="n">album</span>  <span class="ow">&lt;-</span> <span class="n">leftJoin_</span> <span class="p">(</span><span class="n">album</span> <span class="n">chinookDb</span><span class="p">)</span> <span class="p">(</span><span class="nf">\</span><span class="n">album</span> <span class="ow">-&gt;</span> <span class="n">albumArtist</span> <span class="n">album</span> <span class="o">==.</span> <span class="n">primaryKey</span> <span class="n">artist</span><span class="p">)</span>
   <span class="n">pure</span> <span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">album</span><span class="p">)</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-4-sqlite3">
            <div class="codehilite"><pre><span></span><span class="go">SELECT &quot;t0&quot;.&quot;ArtistId&quot; AS &quot;res0&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;Name&quot; AS &quot;res1&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;AlbumId&quot; AS &quot;res2&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;Title&quot; AS &quot;res3&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;ArtistId&quot; AS &quot;res4&quot;</span>
<span class="go">FROM &quot;Artist&quot; AS &quot;t0&quot;</span>
<span class="go">LEFT JOIN &quot;Album&quot; AS &quot;t1&quot; ON (&quot;t1&quot;.&quot;ArtistId&quot;)=(&quot;t0&quot;.&quot;ArtistId&quot;)</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-4-postgres">
            <div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;ArtistId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res0&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Name&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res1&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;AlbumId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res2&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Title&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res3&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;ArtistId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res4&quot;</span>
<span class="k">FROM</span> <span class="s s-Name">&quot;Artist&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;t0&quot;</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="s s-Name">&quot;Album&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;t1&quot;</span> <span class="k">ON</span> <span class="p">(</span><span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;ArtistId&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;ArtistId&quot;</span><span class="p">)</span>
</pre></div>

        </div>
    
        </div>
    
                </div>
                    </p>
<p>Right joins are not yet supported. They can always be rewritten as left joins.
If you have a compelling use case, please file an issue!</p>
<h3 id="full-outer-joins">Full Outer joins</h3>
<div class="admonition todo">
<p class="admonition-title">TODO</p>
<p><code>outerJoin_</code> not yet supported</p>
</div>
<p>Full outer joins are supported via the <code>outerJoin_</code> construct.</p>
<h2 id="subqueries">Subqueries</h2>
<p>Sometimes you want to join against a <em>subquery</em> rather than a table. For the
most part, beam will automatically figure out when certain queries need to be
written using subqueries. For example, to join two result sets cointaining a SQL
LIMIT, you would normally have to write both queries as subqueries. In beam, you
can write such queries as you'd expect. The library takes care of creating
subqueries as expected.</p>
<p>For example, the following query generates the code you'd expect.</p>
<p>
                <div class="code-nav-container">
                    
        <ul class="nav nav-tabs">
            
        <li class="nav-item">
            <a href="#tab-5-haskell" aria-controls="tab-5-haskell" role="tab" data-toggle="tab" data-lang="haskell">Haskell</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-5-sqlite3" aria-controls="tab-5-sqlite3" role="tab" data-toggle="tab" data-lang="sqlite3">Sqlite3</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-5-postgres" aria-controls="tab-5-postgres" role="tab" data-toggle="tab" data-lang="postgres">Postgres</a>
        </li>
    
        </ul>
    
        <div class="tab-content">
            
        <div role="tabpanel" class="tab-pane active" id="tab-5-haskell">
            <div class="codehilite"><pre><span></span><span class="kr">do</span> <span class="n">i</span> <span class="ow">&lt;-</span> <span class="n">limit_</span> <span class="mi">10</span> <span class="o">$</span> <span class="n">all_</span> <span class="p">(</span><span class="n">invoice</span> <span class="n">chinookDb</span><span class="p">)</span>
   <span class="n">line</span> <span class="ow">&lt;-</span> <span class="n">invoiceLines</span> <span class="n">i</span>
   <span class="n">pure</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-5-sqlite3">
            <div class="codehilite"><pre><span></span><span class="go">SELECT &quot;t0&quot;.&quot;res0&quot; AS &quot;res0&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;res1&quot; AS &quot;res1&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;res2&quot; AS &quot;res2&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;res3&quot; AS &quot;res3&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;res4&quot; AS &quot;res4&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;res5&quot; AS &quot;res5&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;res6&quot; AS &quot;res6&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;res7&quot; AS &quot;res7&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;res8&quot; AS &quot;res8&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;InvoiceLineId&quot; AS &quot;res9&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;InvoiceId&quot; AS &quot;res10&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;TrackId&quot; AS &quot;res11&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;UnitPrice&quot; AS &quot;res12&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;Quantity&quot; AS &quot;res13&quot;</span>
<span class="go">FROM</span>
<span class="go">  (SELECT &quot;t0&quot;.&quot;InvoiceId&quot; AS &quot;res0&quot;,</span>
<span class="go">          &quot;t0&quot;.&quot;CustomerId&quot; AS &quot;res1&quot;,</span>
<span class="go">          &quot;t0&quot;.&quot;InvoiceDate&quot; AS &quot;res2&quot;,</span>
<span class="go">          &quot;t0&quot;.&quot;BillingAddress&quot; AS &quot;res3&quot;,</span>
<span class="go">          &quot;t0&quot;.&quot;BillingCity&quot; AS &quot;res4&quot;,</span>
<span class="go">          &quot;t0&quot;.&quot;BillingState&quot; AS &quot;res5&quot;,</span>
<span class="go">          &quot;t0&quot;.&quot;BillingCountry&quot; AS &quot;res6&quot;,</span>
<span class="go">          &quot;t0&quot;.&quot;BillingPostalCode&quot; AS &quot;res7&quot;,</span>
<span class="go">          &quot;t0&quot;.&quot;Total&quot; AS &quot;res8&quot;</span>
<span class="go">   FROM &quot;Invoice&quot; AS &quot;t0&quot;</span>
<span class="go">   LIMIT 10) AS &quot;t0&quot;</span>
<span class="go">INNER JOIN &quot;InvoiceLine&quot; AS &quot;t1&quot; ON (&quot;t1&quot;.&quot;InvoiceId&quot;)=(&quot;t0&quot;.&quot;res0&quot;)</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-5-postgres">
            <div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;res0&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res0&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;res1&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res1&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;res2&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res2&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;res3&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res3&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;res4&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res4&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;res5&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res5&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;res6&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res6&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;res7&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res7&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;res8&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res8&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;InvoiceLineId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res9&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;InvoiceId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res10&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;TrackId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res11&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;UnitPrice&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res12&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Quantity&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res13&quot;</span>
<span class="k">FROM</span>
  <span class="p">(</span><span class="k">SELECT</span> <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;InvoiceId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res0&quot;</span><span class="p">,</span>
          <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;CustomerId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res1&quot;</span><span class="p">,</span>
          <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;InvoiceDate&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res2&quot;</span><span class="p">,</span>
          <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;BillingAddress&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res3&quot;</span><span class="p">,</span>
          <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;BillingCity&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res4&quot;</span><span class="p">,</span>
          <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;BillingState&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res5&quot;</span><span class="p">,</span>
          <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;BillingCountry&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res6&quot;</span><span class="p">,</span>
          <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;BillingPostalCode&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res7&quot;</span><span class="p">,</span>
          <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Total&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res8&quot;</span>
   <span class="k">FROM</span> <span class="s s-Name">&quot;Invoice&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;t0&quot;</span>
   <span class="k">LIMIT</span> <span class="mf">10</span><span class="p">)</span> <span class="k">AS</span> <span class="s s-Name">&quot;t0&quot;</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="s s-Name">&quot;InvoiceLine&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;t1&quot;</span> <span class="k">ON</span> <span class="p">(</span><span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;InvoiceId&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;res0&quot;</span><span class="p">)</span>
</pre></div>

        </div>
    
        </div>
    
                </div>
                    </p>
<p>If you need to (for efficiency for example), you can also generate subqueries
explicitly, using <code>subselect_</code>. The <code>subselect_</code> will force a new query to be
output in most cases. For simple queries, such as <code>all_</code>, <code>subselect_</code> will have
no effect.</p>
<p>
                <div class="code-nav-container">
                    
        <ul class="nav nav-tabs">
            
        <li class="nav-item">
            <a href="#tab-34-haskell" aria-controls="tab-34-haskell" role="tab" data-toggle="tab" data-lang="haskell">Haskell</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-34-sqlite3" aria-controls="tab-34-sqlite3" role="tab" data-toggle="tab" data-lang="sqlite3">Sqlite3</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-34-postgres" aria-controls="tab-34-postgres" role="tab" data-toggle="tab" data-lang="postgres">Postgres</a>
        </li>
    
        </ul>
    
        <div class="tab-content">
            
        <div role="tabpanel" class="tab-pane active" id="tab-34-haskell">
            <div class="codehilite"><pre><span></span><span class="c1">-- Same as above, but with explicit sub select</span>
<span class="kr">do</span> <span class="n">i</span> <span class="ow">&lt;-</span> <span class="n">subselect_</span> <span class="o">$</span> <span class="n">limit_</span> <span class="mi">10</span> <span class="o">$</span> <span class="n">all_</span> <span class="p">(</span><span class="n">invoice</span> <span class="n">chinookDb</span><span class="p">)</span>
   <span class="n">line</span> <span class="ow">&lt;-</span> <span class="n">invoiceLines</span> <span class="n">i</span>
   <span class="n">pure</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-34-sqlite3">
            <div class="codehilite"><pre><span></span><span class="go">SELECT &quot;t0&quot;.&quot;res0&quot; AS &quot;res0&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;res1&quot; AS &quot;res1&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;res2&quot; AS &quot;res2&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;res3&quot; AS &quot;res3&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;res4&quot; AS &quot;res4&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;res5&quot; AS &quot;res5&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;res6&quot; AS &quot;res6&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;res7&quot; AS &quot;res7&quot;,</span>
<span class="go">       &quot;t0&quot;.&quot;res8&quot; AS &quot;res8&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;InvoiceLineId&quot; AS &quot;res9&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;InvoiceId&quot; AS &quot;res10&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;TrackId&quot; AS &quot;res11&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;UnitPrice&quot; AS &quot;res12&quot;,</span>
<span class="go">       &quot;t1&quot;.&quot;Quantity&quot; AS &quot;res13&quot;</span>
<span class="go">FROM</span>
<span class="go">  (SELECT &quot;t0&quot;.&quot;InvoiceId&quot; AS &quot;res0&quot;,</span>
<span class="go">          &quot;t0&quot;.&quot;CustomerId&quot; AS &quot;res1&quot;,</span>
<span class="go">          &quot;t0&quot;.&quot;InvoiceDate&quot; AS &quot;res2&quot;,</span>
<span class="go">          &quot;t0&quot;.&quot;BillingAddress&quot; AS &quot;res3&quot;,</span>
<span class="go">          &quot;t0&quot;.&quot;BillingCity&quot; AS &quot;res4&quot;,</span>
<span class="go">          &quot;t0&quot;.&quot;BillingState&quot; AS &quot;res5&quot;,</span>
<span class="go">          &quot;t0&quot;.&quot;BillingCountry&quot; AS &quot;res6&quot;,</span>
<span class="go">          &quot;t0&quot;.&quot;BillingPostalCode&quot; AS &quot;res7&quot;,</span>
<span class="go">          &quot;t0&quot;.&quot;Total&quot; AS &quot;res8&quot;</span>
<span class="go">   FROM &quot;Invoice&quot; AS &quot;t0&quot;</span>
<span class="go">   LIMIT 10) AS &quot;t0&quot;</span>
<span class="go">INNER JOIN &quot;InvoiceLine&quot; AS &quot;t1&quot; ON (&quot;t1&quot;.&quot;InvoiceId&quot;)=(&quot;t0&quot;.&quot;res0&quot;)</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-34-postgres">
            <div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;res0&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res0&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;res1&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res1&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;res2&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res2&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;res3&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res3&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;res4&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res4&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;res5&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res5&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;res6&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res6&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;res7&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res7&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;res8&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res8&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;InvoiceLineId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res9&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;InvoiceId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res10&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;TrackId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res11&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;UnitPrice&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res12&quot;</span><span class="p">,</span>
       <span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Quantity&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res13&quot;</span>
<span class="k">FROM</span>
  <span class="p">(</span><span class="k">SELECT</span> <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;InvoiceId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res0&quot;</span><span class="p">,</span>
          <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;CustomerId&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res1&quot;</span><span class="p">,</span>
          <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;InvoiceDate&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res2&quot;</span><span class="p">,</span>
          <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;BillingAddress&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res3&quot;</span><span class="p">,</span>
          <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;BillingCity&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res4&quot;</span><span class="p">,</span>
          <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;BillingState&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res5&quot;</span><span class="p">,</span>
          <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;BillingCountry&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res6&quot;</span><span class="p">,</span>
          <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;BillingPostalCode&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res7&quot;</span><span class="p">,</span>
          <span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;Total&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;res8&quot;</span>
   <span class="k">FROM</span> <span class="s s-Name">&quot;Invoice&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;t0&quot;</span>
   <span class="k">LIMIT</span> <span class="mf">10</span><span class="p">)</span> <span class="k">AS</span> <span class="s s-Name">&quot;t0&quot;</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="s s-Name">&quot;InvoiceLine&quot;</span> <span class="k">AS</span> <span class="s s-Name">&quot;t1&quot;</span> <span class="k">ON</span> <span class="p">(</span><span class="s s-Name">&quot;t1&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;InvoiceId&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="s s-Name">&quot;t0&quot;</span><span class="mf">.</span><span class="s s-Name">&quot;res0&quot;</span><span class="p">)</span>
</pre></div>

        </div>
    
        </div>
    
                </div>
                    </p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../ordering/" title="Ordering" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Ordering
              </span>
            </div>
          </a>
        
        
          <a href="../aggregates/" title="Aggregates" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Aggregates
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    

      <script src="../../../assets/javascripts/application-6b599127bc.js"></script>
      <script>app.initialize({url:{base:"../../.."}})</script>
      
    
<script type="text/javascript" language="javascript"  src="http://code.jquery.com/jquery-2.2.4.min.js"></script>
<script type="text/javascript" language="javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script type="text/javascript" language="javascript">
 $(document.body).tab();
 $(".nav-item:first-child").tab("show");
</script>

    
      
    
  </body>
</html>