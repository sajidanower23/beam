<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>Relationships - Beam Documentation</title>

  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/highlight.css">
  <link href="../../../theme/css/beam.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="css/beam.css"/>

  
  <script>
    // Current page data
    var mkdocs_page_name = "Relationships";
    var mkdocs_page_input_path = "user-guide/queries/relationships.md";
    var mkdocs_page_url = "/user-guide/queries/relationships/";
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js"></script>
  <script src="../../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> Beam Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../about/faq/">Frequently Asked Questions</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">User Guide</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../getting-started/">Getting Started</a>
                </li>
                <li class="">
                    
    <a class="" href="../../models/">Models</a>
                </li>
                <li class="">
                    
    <a class="" href="../../databases/">Databases</a>
                </li>
                <li class="">
                    
    <a class="" href="../basic/">Basic Queries</a>
                </li>
                <li class="">
                    
    <a class="" href="../select/">More complex SELECTs</a>
                </li>
                <li class="">
                    
    <a class="" href="../ordering/">Ordering</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Relationships</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#one-to-many">One-to-many</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#nullable-columns">Nullable columns</a></li>
        
            <li><a class="toctree-l4" href="#one-to-one">One-to-one</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#many-to-many">Many-to-many</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#many-to-many-with-arbitrary-data">Many-to-many with arbitrary data</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#arbitrary-joins">Arbitrary Joins</a></li>
    

    <li class="toctree-l3"><a href="#outer-joins">Outer joins</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#left-and-right-joins">Left and right joins</a></li>
        
            <li><a class="toctree-l4" href="#full-outer-joins">Full Outer joins</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#subqueries">Subqueries</a></li>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../aggregates/">Aggregates</a>
                </li>
                <li class="">
                    
    <a class="" href="../combining-queries/">Combining queries</a>
                </li>
                <li class="">
                    
    <a class="" href="../window-functions/">Window functions</a>
                </li>
                <li class="">
                    
    <a class="" href="../advanced-features/">Advanced features</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Schema management</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../schema-guide/migrations/">The Migrations Framework</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../schema-guide/tool/">The beam-migrate tool</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../schema-guide/supported/">Supported migrations</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Backends</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../backends/beam-postgres/">beam-postgres</a>
                </li>
                <li class="">
                    
    <a class="" href="../../backends/beam-sqlite/">beam-sqlite</a>
                </li>
                <li class="">
                    
    <a class="" href="../../custom-backends/">Writing a Custom Backend</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Reference</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../reference/models/">Models</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../reference/expression/">Expressions</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../reference/queries/">Queries</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../reference/extensibility/">Extending</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">About</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../about/compatibility/">Compatibility Matrix</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../about/license/">License</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../about/release-notes/">Release Notes</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">Beam Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>User Guide &raquo;</li>
        
      
    
    <li>Relationships</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>Relational databases are so-named because they're good at expressing relations
among data and providing related data in queries. Beam exposes these features in
its DSL.</p>
<p>For these examples, we're going to use the <code>beam-sqlite</code> backend with the
provided sample Chinook database.</p>
<p>First, create a SQLite database from the included example.</p>
<pre><code  class="">&gt; sqlite3 chinook.db &lt; beam-sqlite/examples/chinook.sql
</code></pre>

<p>Now, load the chinook database schema in GHCi.</p>
<pre><code  class="haskell">Prelude Database.Beam.Sqlite&gt; :load beam-sqlite/examples/Chinook/Schema.hs
Prelude Chinook.Schema&gt; chinook &lt;- open &quot;chinook.db&quot;
</code></pre>

<p>One more thing, before we explore how beam handles relationships. Before we do, let's define a quick utility function.</p>
<pre><code  class="haskell">Prelude Chinook.Schema&gt; let withConnectionTutorial = withDatabaseDebug putStrLn chinook
</code></pre>

<p>This function prints each of our queries to standard output before running them.
Using this function will let us see what SQL is executing.</p>
<h2 id="one-to-many">One-to-many</h2>
<p>Beam supports querying for one-to-many joins. For example, to get every
<code>InvoiceLine</code> for each <code>Invoice</code>, use the <code>oneToMany_</code> combinator.</p>
<p>
                <div class="code-nav-container">
                    
        <ul class="nav nav-tabs">
            
        <li class="nav-item">
            <a href="#tab-0-haskell" aria-controls="tab-0-haskell" role="tab" data-toggle="tab" data-lang="haskell">Haskell</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-0-sqlite3" aria-controls="tab-0-sqlite3" role="tab" data-toggle="tab" data-lang="sqlite3">Sqlite3</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-0-postgres" aria-controls="tab-0-postgres" role="tab" data-toggle="tab" data-lang="postgres">Postgres</a>
        </li>
    
        </ul>
    
        <div class="tab-content">
            
        <div role="tabpanel" class="tab-pane active" id="tab-0-haskell">
            <pre><code  class="haskell">do i &lt;- all_ (invoice chinookDb)
   ln &lt;- oneToMany_ (invoiceLine chinookDb) invoiceLineInvoice i
   pure (i, ln)
</code></pre>
        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-0-sqlite3">
            <pre><code  class="sqlite3">SELECT &quot;t0&quot;.&quot;InvoiceId&quot; AS &quot;res0&quot;,
       &quot;t0&quot;.&quot;CustomerId&quot; AS &quot;res1&quot;,
       &quot;t0&quot;.&quot;InvoiceDate&quot; AS &quot;res2&quot;,
       &quot;t0&quot;.&quot;BillingAddress&quot; AS &quot;res3&quot;,
       &quot;t0&quot;.&quot;BillingCity&quot; AS &quot;res4&quot;,
       &quot;t0&quot;.&quot;BillingState&quot; AS &quot;res5&quot;,
       &quot;t0&quot;.&quot;BillingCountry&quot; AS &quot;res6&quot;,
       &quot;t0&quot;.&quot;BillingPostalCode&quot; AS &quot;res7&quot;,
       &quot;t0&quot;.&quot;Total&quot; AS &quot;res8&quot;,
       &quot;t1&quot;.&quot;InvoiceLineId&quot; AS &quot;res9&quot;,
       &quot;t1&quot;.&quot;InvoiceId&quot; AS &quot;res10&quot;,
       &quot;t1&quot;.&quot;TrackId&quot; AS &quot;res11&quot;,
       &quot;t1&quot;.&quot;UnitPrice&quot; AS &quot;res12&quot;,
       &quot;t1&quot;.&quot;Quantity&quot; AS &quot;res13&quot;
FROM &quot;Invoice&quot; AS &quot;t0&quot;
INNER JOIN &quot;InvoiceLine&quot; AS &quot;t1&quot; ON (&quot;t1&quot;.&quot;InvoiceId&quot;)=(&quot;t0&quot;.&quot;InvoiceId&quot;)
</code></pre>
        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-0-postgres">
            <pre><code  class="postgres">SELECT &quot;t0&quot;.&quot;InvoiceId&quot; AS &quot;res0&quot;,
       &quot;t0&quot;.&quot;CustomerId&quot; AS &quot;res1&quot;,
       &quot;t0&quot;.&quot;InvoiceDate&quot; AS &quot;res2&quot;,
       &quot;t0&quot;.&quot;BillingAddress&quot; AS &quot;res3&quot;,
       &quot;t0&quot;.&quot;BillingCity&quot; AS &quot;res4&quot;,
       &quot;t0&quot;.&quot;BillingState&quot; AS &quot;res5&quot;,
       &quot;t0&quot;.&quot;BillingCountry&quot; AS &quot;res6&quot;,
       &quot;t0&quot;.&quot;BillingPostalCode&quot; AS &quot;res7&quot;,
       &quot;t0&quot;.&quot;Total&quot; AS &quot;res8&quot;,
       &quot;t1&quot;.&quot;InvoiceLineId&quot; AS &quot;res9&quot;,
       &quot;t1&quot;.&quot;InvoiceId&quot; AS &quot;res10&quot;,
       &quot;t1&quot;.&quot;TrackId&quot; AS &quot;res11&quot;,
       &quot;t1&quot;.&quot;UnitPrice&quot; AS &quot;res12&quot;,
       &quot;t1&quot;.&quot;Quantity&quot; AS &quot;res13&quot;
FROM &quot;Invoice&quot; AS &quot;t0&quot;
INNER JOIN &quot;InvoiceLine&quot; AS &quot;t1&quot; ON (&quot;t1&quot;.&quot;InvoiceId&quot;) = (&quot;t0&quot;.&quot;InvoiceId&quot;)
</code></pre>
        </div>
    
        </div>
    
                </div>
                    </p>
<p>Or, if you have an actual <code>Invoice</code> (called <code>oneInvoice</code>) and you want all the
associated <code>InvoiceLine</code>s, you can use <code>val_</code> to convert <code>oneInvoice</code> to the SQL
expression level.</p>
<pre><code  class="haskell">oneToMany_ (invoiceLine chinookDb) invoiceLineInvoice (val_ i)
</code></pre>

<p>If you find yourself repeating yourself constantly, you can define a helper.</p>
<pre><code  class="haskell">invoiceLines_ :: OneToMany InvoiceT InvoiceLineT
invoiceLines_ = oneToMany_ (invoiceLine chinookDb) invoiceLineInvoice
</code></pre>

<p>Then the above queries become</p>
<pre><code  class="haskell">do i &lt;- all_ (invoice chinookDb)
   ln &lt;- invoiceLines_ i
</code></pre>

<p>and</p>
<pre><code  class="haskell">invoiceLines (val_ i)
</code></pre>

<h3 id="nullable-columns">Nullable columns</h3>
<p>If you have a nullable foreign key in your many table, you can use
<code>oneToManyOptional_</code> and <code>OneToManyOptional</code>, respectively. For example, </p>
<h3 id="one-to-one">One-to-one</h3>
<p>One to one relationships are a special case of one to many relationships, save
for a unique constraint on one column. Thus, there are no special constructs for
one-to-one relationships.</p>
<p>For convenience, <code>oneToOne_</code> and <code>OneToOne</code> are equivalent to <code>oneToMany_</code> and
<code>OneToMany</code>. Additionally, <code>oneToMaybe_</code> and <code>OneToMaybe</code> correspond to
<code>oneToManyOptional_</code> and <code>OneToManyOptional</code>.</p>
<h2 id="many-to-many">Many-to-many</h2>
<p>Many to many relationships require a linking table, with foreign keys to each
table part of the relationship.</p>
<p>The <code>manyToMany_</code> construct can be used to fetch both, one, or no sides of a
many-to-many relationship.</p>
<pre><code  class="haskell">manyToMany_ :: ( Database db, Table joinThrough
               , Table left, Table right
               , Sql92SelectSanityCheck syntax
               , IsSql92SelectSyntax syntax

               , SqlOrd (QExpr (Sql92SelectExpressionSyntax syntax) s) (PrimaryKey left g)
               , SqlOrd (QExpr (Sql92SelectExpressionSyntax syntax) s) (PrimaryKey right h) )
            =&gt; DatabaseEntity be db (TableEntity joinThrough)
            -&gt; (joinThrough (QExpr (Sql92SelectExpressionSyntax syntax) s) -&gt; PrimaryKey left g)
            -&gt; (joinThrough (QExpr (Sql92SelectExpressionSyntax syntax) s) -&gt; PrimaryKey right h)
            -&gt; Q syntax db s (left g) -&gt; Q syntax db s (right h)
            -&gt; Q syntax db s (left g, right h)
</code></pre>

<p>This reads: for any database <code>db</code>; tables <code>joinThrough</code>, <code>left</code>, and <code>right</code>;
and sane select syntax <code>syntax</code>, where the primary keys of <code>left</code> and <code>right</code>
are comparable as value expressions and we have some way of extracting a primary
key of <code>left</code> and <code>right</code> from <code>joinThrough</code>, associate all entries of <code>left</code>
with those of <code>right</code> through <code>joinThrough</code> and return the results of <code>left</code> and
<code>right</code>.</p>
<p>For example, </p>
<h3 id="many-to-many-with-arbitrary-data">Many-to-many with arbitrary data</h3>
<p>Sometimes you want to have additional data for each relationship. For this, use
<code>manyToManyPassthrough_</code>.</p>
<pre><code  class="haskell">manyToManyPassthrough_ 
    :: ( Database db, Table joinThrough
       , Table left, Table right
       , Sql92SelectSanityCheck syntax
       , IsSql92SelectSyntax syntax

       , SqlOrd (QExpr (Sql92SelectExpressionSyntax syntax) s) (PrimaryKey left g)
       , SqlOrd (QExpr (Sql92SelectExpressionSyntax syntax) s) (PrimaryKey right h) )
    =&gt; DatabaseEntity be db (TableEntity joinThrough)
    -&gt; (joinThrough (QExpr (Sql92SelectExpressionSyntax syntax) s) -&gt; PrimaryKey left g)
    -&gt; (joinThrough (QExpr (Sql92SelectExpressionSyntax syntax) s) -&gt; PrimaryKey right h)
    -&gt; Q syntax db s (left g) -&gt; Q syntax db s (right h)
    -&gt; Q syntax db s (joinThrough (QExpr (Sql92SelectExpressionSyntax syntax) s), left g, right h)
</code></pre>

<p>Under the hood <code>manyToMany_</code> is defined simply as </p>
<pre><code  class="haskell">manyToMany_ = fmap (\(_, left, right) -&gt; (left, right)) manyToManyPassthrough_
</code></pre>

<div class="admonition todo">
<p class="admonition-title">TODO</p>
<p>It would be nice to have a <code>ManyToMany</code> type or some equivalent.</p>
</div>
<h2 id="arbitrary-joins">Arbitrary Joins</h2>
<p>Joins with arbitrary conditions can be specified using the <code>join_</code> construct.</p>
<h2 id="outer-joins">Outer joins</h2>
<h3 id="left-and-right-joins">Left and right joins</h3>
<p>Left joins with arbitrary conditions can be specified with the <code>leftJoin_</code>
construct. <code>leftJoin_</code> takes a table and a join condition. It associates each
result record with a record of the table given or an fully NULL row of that
table in case no row matches. For this reason, the result of <code>leftJoin_</code> has an
extra <code>Nullable</code> column tag, which converts each field into the corresponding
<code>Maybe</code> type.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The table parameter passed in as the join condition does not have a 
<code>Nullable</code> column tag. The join condition should be written as if a 
concrete row from that table exists.</p>
</div>
<p>For example, to get every artist along with their albums, but always including
every artist, use <code>leftJoin_</code> as follows.</p>
<p>
                <div class="code-nav-container">
                    
        <ul class="nav nav-tabs">
            
        <li class="nav-item">
            <a href="#tab-1-haskell" aria-controls="tab-1-haskell" role="tab" data-toggle="tab" data-lang="haskell">Haskell</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-1-sqlite3" aria-controls="tab-1-sqlite3" role="tab" data-toggle="tab" data-lang="sqlite3">Sqlite3</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-1-postgres" aria-controls="tab-1-postgres" role="tab" data-toggle="tab" data-lang="postgres">Postgres</a>
        </li>
    
        </ul>
    
        <div class="tab-content">
            
        <div role="tabpanel" class="tab-pane active" id="tab-1-haskell">
            <pre><code  class="haskell">do artist &lt;- all_ (artist chinookDb)
   album  &lt;- leftJoin_ (album chinookDb) (\album -&gt; albumArtist album ==. primaryKey artist)
   pure (artist, album)
</code></pre>
        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-1-sqlite3">
            <pre><code  class="sqlite3">SELECT &quot;t0&quot;.&quot;ArtistId&quot; AS &quot;res0&quot;,
       &quot;t0&quot;.&quot;Name&quot; AS &quot;res1&quot;,
       &quot;t1&quot;.&quot;AlbumId&quot; AS &quot;res2&quot;,
       &quot;t1&quot;.&quot;Title&quot; AS &quot;res3&quot;,
       &quot;t1&quot;.&quot;ArtistId&quot; AS &quot;res4&quot;
FROM &quot;Artist&quot; AS &quot;t0&quot;
LEFT JOIN &quot;Album&quot; AS &quot;t1&quot; ON (&quot;t1&quot;.&quot;ArtistId&quot;)=(&quot;t0&quot;.&quot;ArtistId&quot;)
</code></pre>
        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-1-postgres">
            <pre><code  class="postgres">SELECT &quot;t0&quot;.&quot;ArtistId&quot; AS &quot;res0&quot;,
       &quot;t0&quot;.&quot;Name&quot; AS &quot;res1&quot;,
       &quot;t1&quot;.&quot;AlbumId&quot; AS &quot;res2&quot;,
       &quot;t1&quot;.&quot;Title&quot; AS &quot;res3&quot;,
       &quot;t1&quot;.&quot;ArtistId&quot; AS &quot;res4&quot;
FROM &quot;Artist&quot; AS &quot;t0&quot;
LEFT JOIN &quot;Album&quot; AS &quot;t1&quot; ON (&quot;t1&quot;.&quot;ArtistId&quot;) = (&quot;t0&quot;.&quot;ArtistId&quot;)
</code></pre>
        </div>
    
        </div>
    
                </div>
                    </p>
<p>Right joins are not yet supported. They can always be rewritten as left joins.
If you have a compelling use case, please file an issue!</p>
<h3 id="full-outer-joins">Full Outer joins</h3>
<div class="admonition todo">
<p class="admonition-title">TODO</p>
<p><code>outerJoin_</code> not yet supported</p>
</div>
<p>Full outer joins are supported via the <code>outerJoin_</code> construct.</p>
<h2 id="subqueries">Subqueries</h2>
<p>Sometimes you want to join against a <em>subquery</em> rather than a table. For the
most part, beam will automatically figure out when certain queries need to be
written using subqueries. For example, to join two result sets cointaining a SQL
LIMIT, you would normally have to write both queries as subqueries. In beam, you
can write such queries as you'd expect. The library takes care of creating
subqueries as expected.</p>
<p>For example, the following query generates the code you'd expect.</p>
<p>
                <div class="code-nav-container">
                    
        <ul class="nav nav-tabs">
            
        <li class="nav-item">
            <a href="#tab-2-haskell" aria-controls="tab-2-haskell" role="tab" data-toggle="tab" data-lang="haskell">Haskell</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-2-sqlite3" aria-controls="tab-2-sqlite3" role="tab" data-toggle="tab" data-lang="sqlite3">Sqlite3</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-2-postgres" aria-controls="tab-2-postgres" role="tab" data-toggle="tab" data-lang="postgres">Postgres</a>
        </li>
    
        </ul>
    
        <div class="tab-content">
            
        <div role="tabpanel" class="tab-pane active" id="tab-2-haskell">
            <pre><code  class="haskell">do i &lt;- limit_ 10 $ all_ (invoice chinookDb)
   line &lt;- invoiceLines i
   pure (i, line)
</code></pre>
        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-2-sqlite3">
            <pre><code  class="sqlite3">SELECT &quot;t0&quot;.&quot;res0&quot; AS &quot;res0&quot;,
       &quot;t0&quot;.&quot;res1&quot; AS &quot;res1&quot;,
       &quot;t0&quot;.&quot;res2&quot; AS &quot;res2&quot;,
       &quot;t0&quot;.&quot;res3&quot; AS &quot;res3&quot;,
       &quot;t0&quot;.&quot;res4&quot; AS &quot;res4&quot;,
       &quot;t0&quot;.&quot;res5&quot; AS &quot;res5&quot;,
       &quot;t0&quot;.&quot;res6&quot; AS &quot;res6&quot;,
       &quot;t0&quot;.&quot;res7&quot; AS &quot;res7&quot;,
       &quot;t0&quot;.&quot;res8&quot; AS &quot;res8&quot;,
       &quot;t1&quot;.&quot;InvoiceLineId&quot; AS &quot;res9&quot;,
       &quot;t1&quot;.&quot;InvoiceId&quot; AS &quot;res10&quot;,
       &quot;t1&quot;.&quot;TrackId&quot; AS &quot;res11&quot;,
       &quot;t1&quot;.&quot;UnitPrice&quot; AS &quot;res12&quot;,
       &quot;t1&quot;.&quot;Quantity&quot; AS &quot;res13&quot;
FROM
  (SELECT &quot;t0&quot;.&quot;InvoiceId&quot; AS &quot;res0&quot;,
          &quot;t0&quot;.&quot;CustomerId&quot; AS &quot;res1&quot;,
          &quot;t0&quot;.&quot;InvoiceDate&quot; AS &quot;res2&quot;,
          &quot;t0&quot;.&quot;BillingAddress&quot; AS &quot;res3&quot;,
          &quot;t0&quot;.&quot;BillingCity&quot; AS &quot;res4&quot;,
          &quot;t0&quot;.&quot;BillingState&quot; AS &quot;res5&quot;,
          &quot;t0&quot;.&quot;BillingCountry&quot; AS &quot;res6&quot;,
          &quot;t0&quot;.&quot;BillingPostalCode&quot; AS &quot;res7&quot;,
          &quot;t0&quot;.&quot;Total&quot; AS &quot;res8&quot;
   FROM &quot;Invoice&quot; AS &quot;t0&quot;
   LIMIT 10) AS &quot;t0&quot;
INNER JOIN &quot;InvoiceLine&quot; AS &quot;t1&quot; ON (&quot;t1&quot;.&quot;InvoiceId&quot;)=(&quot;t0&quot;.&quot;res0&quot;)
</code></pre>
        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-2-postgres">
            <pre><code  class="postgres">SELECT &quot;t0&quot;.&quot;res0&quot; AS &quot;res0&quot;,
       &quot;t0&quot;.&quot;res1&quot; AS &quot;res1&quot;,
       &quot;t0&quot;.&quot;res2&quot; AS &quot;res2&quot;,
       &quot;t0&quot;.&quot;res3&quot; AS &quot;res3&quot;,
       &quot;t0&quot;.&quot;res4&quot; AS &quot;res4&quot;,
       &quot;t0&quot;.&quot;res5&quot; AS &quot;res5&quot;,
       &quot;t0&quot;.&quot;res6&quot; AS &quot;res6&quot;,
       &quot;t0&quot;.&quot;res7&quot; AS &quot;res7&quot;,
       &quot;t0&quot;.&quot;res8&quot; AS &quot;res8&quot;,
       &quot;t1&quot;.&quot;InvoiceLineId&quot; AS &quot;res9&quot;,
       &quot;t1&quot;.&quot;InvoiceId&quot; AS &quot;res10&quot;,
       &quot;t1&quot;.&quot;TrackId&quot; AS &quot;res11&quot;,
       &quot;t1&quot;.&quot;UnitPrice&quot; AS &quot;res12&quot;,
       &quot;t1&quot;.&quot;Quantity&quot; AS &quot;res13&quot;
FROM
  (SELECT &quot;t0&quot;.&quot;InvoiceId&quot; AS &quot;res0&quot;,
          &quot;t0&quot;.&quot;CustomerId&quot; AS &quot;res1&quot;,
          &quot;t0&quot;.&quot;InvoiceDate&quot; AS &quot;res2&quot;,
          &quot;t0&quot;.&quot;BillingAddress&quot; AS &quot;res3&quot;,
          &quot;t0&quot;.&quot;BillingCity&quot; AS &quot;res4&quot;,
          &quot;t0&quot;.&quot;BillingState&quot; AS &quot;res5&quot;,
          &quot;t0&quot;.&quot;BillingCountry&quot; AS &quot;res6&quot;,
          &quot;t0&quot;.&quot;BillingPostalCode&quot; AS &quot;res7&quot;,
          &quot;t0&quot;.&quot;Total&quot; AS &quot;res8&quot;
   FROM &quot;Invoice&quot; AS &quot;t0&quot;
   LIMIT 10) AS &quot;t0&quot;
INNER JOIN &quot;InvoiceLine&quot; AS &quot;t1&quot; ON (&quot;t1&quot;.&quot;InvoiceId&quot;) = (&quot;t0&quot;.&quot;res0&quot;)
</code></pre>
        </div>
    
        </div>
    
                </div>
                    </p>
<p>If you need to (for efficiency for example), you can also generate subqueries
explicitly, using <code>subselect_</code>. The <code>subselect_</code> will force a new query to be
output in most cases. For simple queries, such as <code>all_</code>, <code>subselect_</code> will have
no effect.</p>
<p>
                <div class="code-nav-container">
                    
        <ul class="nav nav-tabs">
            
        <li class="nav-item">
            <a href="#tab-22-haskell" aria-controls="tab-22-haskell" role="tab" data-toggle="tab" data-lang="haskell">Haskell</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-22-sqlite3" aria-controls="tab-22-sqlite3" role="tab" data-toggle="tab" data-lang="sqlite3">Sqlite3</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-22-postgres" aria-controls="tab-22-postgres" role="tab" data-toggle="tab" data-lang="postgres">Postgres</a>
        </li>
    
        </ul>
    
        <div class="tab-content">
            
        <div role="tabpanel" class="tab-pane active" id="tab-22-haskell">
            <pre><code  class="haskell">-- Same as above, but with explicit sub select
do i &lt;- subselect_ $ limit_ 10 $ all_ (invoice chinookDb)
   line &lt;- invoiceLines i
   pure (i, line)
</code></pre>
        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-22-sqlite3">
            <pre><code  class="sqlite3">SELECT &quot;t0&quot;.&quot;res0&quot; AS &quot;res0&quot;,
       &quot;t0&quot;.&quot;res1&quot; AS &quot;res1&quot;,
       &quot;t0&quot;.&quot;res2&quot; AS &quot;res2&quot;,
       &quot;t0&quot;.&quot;res3&quot; AS &quot;res3&quot;,
       &quot;t0&quot;.&quot;res4&quot; AS &quot;res4&quot;,
       &quot;t0&quot;.&quot;res5&quot; AS &quot;res5&quot;,
       &quot;t0&quot;.&quot;res6&quot; AS &quot;res6&quot;,
       &quot;t0&quot;.&quot;res7&quot; AS &quot;res7&quot;,
       &quot;t0&quot;.&quot;res8&quot; AS &quot;res8&quot;,
       &quot;t1&quot;.&quot;InvoiceLineId&quot; AS &quot;res9&quot;,
       &quot;t1&quot;.&quot;InvoiceId&quot; AS &quot;res10&quot;,
       &quot;t1&quot;.&quot;TrackId&quot; AS &quot;res11&quot;,
       &quot;t1&quot;.&quot;UnitPrice&quot; AS &quot;res12&quot;,
       &quot;t1&quot;.&quot;Quantity&quot; AS &quot;res13&quot;
FROM
  (SELECT &quot;t0&quot;.&quot;InvoiceId&quot; AS &quot;res0&quot;,
          &quot;t0&quot;.&quot;CustomerId&quot; AS &quot;res1&quot;,
          &quot;t0&quot;.&quot;InvoiceDate&quot; AS &quot;res2&quot;,
          &quot;t0&quot;.&quot;BillingAddress&quot; AS &quot;res3&quot;,
          &quot;t0&quot;.&quot;BillingCity&quot; AS &quot;res4&quot;,
          &quot;t0&quot;.&quot;BillingState&quot; AS &quot;res5&quot;,
          &quot;t0&quot;.&quot;BillingCountry&quot; AS &quot;res6&quot;,
          &quot;t0&quot;.&quot;BillingPostalCode&quot; AS &quot;res7&quot;,
          &quot;t0&quot;.&quot;Total&quot; AS &quot;res8&quot;
   FROM &quot;Invoice&quot; AS &quot;t0&quot;
   LIMIT 10) AS &quot;t0&quot;
INNER JOIN &quot;InvoiceLine&quot; AS &quot;t1&quot; ON (&quot;t1&quot;.&quot;InvoiceId&quot;)=(&quot;t0&quot;.&quot;res0&quot;)
</code></pre>
        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-22-postgres">
            <pre><code  class="postgres">SELECT &quot;t0&quot;.&quot;res0&quot; AS &quot;res0&quot;,
       &quot;t0&quot;.&quot;res1&quot; AS &quot;res1&quot;,
       &quot;t0&quot;.&quot;res2&quot; AS &quot;res2&quot;,
       &quot;t0&quot;.&quot;res3&quot; AS &quot;res3&quot;,
       &quot;t0&quot;.&quot;res4&quot; AS &quot;res4&quot;,
       &quot;t0&quot;.&quot;res5&quot; AS &quot;res5&quot;,
       &quot;t0&quot;.&quot;res6&quot; AS &quot;res6&quot;,
       &quot;t0&quot;.&quot;res7&quot; AS &quot;res7&quot;,
       &quot;t0&quot;.&quot;res8&quot; AS &quot;res8&quot;,
       &quot;t1&quot;.&quot;InvoiceLineId&quot; AS &quot;res9&quot;,
       &quot;t1&quot;.&quot;InvoiceId&quot; AS &quot;res10&quot;,
       &quot;t1&quot;.&quot;TrackId&quot; AS &quot;res11&quot;,
       &quot;t1&quot;.&quot;UnitPrice&quot; AS &quot;res12&quot;,
       &quot;t1&quot;.&quot;Quantity&quot; AS &quot;res13&quot;
FROM
  (SELECT &quot;t0&quot;.&quot;InvoiceId&quot; AS &quot;res0&quot;,
          &quot;t0&quot;.&quot;CustomerId&quot; AS &quot;res1&quot;,
          &quot;t0&quot;.&quot;InvoiceDate&quot; AS &quot;res2&quot;,
          &quot;t0&quot;.&quot;BillingAddress&quot; AS &quot;res3&quot;,
          &quot;t0&quot;.&quot;BillingCity&quot; AS &quot;res4&quot;,
          &quot;t0&quot;.&quot;BillingState&quot; AS &quot;res5&quot;,
          &quot;t0&quot;.&quot;BillingCountry&quot; AS &quot;res6&quot;,
          &quot;t0&quot;.&quot;BillingPostalCode&quot; AS &quot;res7&quot;,
          &quot;t0&quot;.&quot;Total&quot; AS &quot;res8&quot;
   FROM &quot;Invoice&quot; AS &quot;t0&quot;
   LIMIT 10) AS &quot;t0&quot;
INNER JOIN &quot;InvoiceLine&quot; AS &quot;t1&quot; ON (&quot;t1&quot;.&quot;InvoiceId&quot;) = (&quot;t0&quot;.&quot;res0&quot;)
</code></pre>
        </div>
    
        </div>
    
                </div>
                    </p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../aggregates/" class="btn btn-neutral float-right" title="Aggregates">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../ordering/" class="btn btn-neutral" title="Ordering"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../ordering/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../aggregates/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

    <script src="../../../js/theme.js"></script>
<script type="text/javascript" language="javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script type="text/javascript" language="javascript">
 $(document.body).tab();
</script>


</body>
</html>
